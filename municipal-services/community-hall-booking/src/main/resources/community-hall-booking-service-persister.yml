serviceMaps:
 serviceName: community-hall-booking-service
 mappings:
 - version: 1.0
   description: Persists incomplete community hall booking details in community_hall_booking_init  table
   fromTopic: save-community-hall-booking-init
   isTransaction: true
   queryMaps:

       - query: INSERT INTO public.community_hall_booking_init(booking_id, tenant_id, community_hall_id, booking_status, booking_details, createdby, createdtime, lastmodifiedby, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?); 
         basePath: hallsBookingApplication
         jsonMaps:
          - jsonPath: $.hallsBookingApplication.bookingId

          - jsonPath: $.hallsBookingApplication.tenantId
          
          - jsonPath: $.hallsBookingApplication.communityHallId
          
          - jsonPath: $.hallsBookingApplication.bookingStatus

          - jsonPath: $.hallsBookingApplication.bookingDetails
            type: JSON
            dbType: JSONB

          - jsonPath: $.hallsBookingApplication.createdBy
          
          - jsonPath: $.hallsBookingApplication.createdDate
          
          - jsonPath: $.hallsBookingApplication.lastModifiedBy
          
          - jsonPath: $.hallsBookingApplication.lastModifiedDate



 - version: 1.0
   description: Persists community hall booking details after application is completed community_hall_booking  table
   fromTopic: save-community-hall-booking
   isTransaction: true
   queryMaps:

       - query: INSERT INTO public.community_hall_booking_details(booking_id, booking_no,booking_date, applicant_name, applicant_email_id,applicant_mobile_no, applicant_alternate_mobile_no, tenant_id, community_hall_id,community_hall_name, booking_status, resident_type, special_category, purpose, purpose_description,event_name, event_organized_by, createdby, createdtime, lastmodifiedby, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: hallsBookingApplication
         jsonMaps:
          - jsonPath: $.hallsBookingApplication.bookingId
          
          - jsonPath: $.hallsBookingApplication.bookingNo
          
          - jsonPath: $.hallsBookingApplication.bookingDate
          
          - jsonPath: $.hallsBookingApplication.applicantName

          - jsonPath: $.hallsBookingApplication.applicantEmailId
          
          - jsonPath: $.hallsBookingApplication.applicantMobileNo

          - jsonPath: $.hallsBookingApplication.applicantAlternateMobileNo

          - jsonPath: $.hallsBookingApplication.tenantId
          
          - jsonPath: $.hallsBookingApplication.communityHallId

          - jsonPath: $.hallsBookingApplication.communityHallName
          
          - jsonPath: $.hallsBookingApplication.bookingStatus
          
          - jsonPath: $.hallsBookingApplication.residentType.type 
          
          - jsonPath: $.hallsBookingApplication.specialCategory.category
          
          - jsonPath: $.hallsBookingApplication.purpose.purpose
          
          - jsonPath: $.hallsBookingApplication.purposeDescription
          
          - jsonPath: $.hallsBookingApplication.eventName
          
          - jsonPath: $.hallsBookingApplication.eventOrganisedBy

          - jsonPath: $.hallsBookingApplication.auditDetails.createdBy
          
          - jsonPath: $.hallsBookingApplication.auditDetails.createdTime
          
          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedBy
          
          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedTime
          
       - query: INSERT INTO public.booking_slot_details(slot_id, booking_id, hall_code, hall_name, booking_date, booking_from_time, booking_to_time, status, createdby, createdtime, lastmodifiedby, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?);
         basePath: hallsBookingApplication.bookingSlotDetails.*
         jsonMaps:
          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.slotId

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.bookingId

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.hallCode

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.hallName

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.bookingDate

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.bookingFromTime

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.bookingToTime

          - jsonPath: $.hallsBookingApplication.bookingSlotDetails.*.status

          - jsonPath: $.hallsBookingApplication.auditDetails.createdBy
          
          - jsonPath: $.hallsBookingApplication.auditDetails.createdTime

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedBy

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedTime
          
       - query: INSERT INTO public.community_hall_booking_document_details(document_detail_id, booking_id, document_type, filestore_id, createdby, lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?);
         basePath: hallsBookingApplication.uploadedDocumentDetails.*
         jsonMaps:
          - jsonPath: $.hallsBookingApplication.uploadedDocumentDetails.*.documentId

          - jsonPath: $.hallsBookingApplication.uploadedDocumentDetails.*.bookingId

          - jsonPath: $.hallsBookingApplication.uploadedDocumentDetails.*.documentType

          - jsonPath: $.hallsBookingApplication.uploadedDocumentDetails.*.fileStoreId

          - jsonPath: $.hallsBookingApplication.auditDetails.createdBy

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedBy

          - jsonPath: $.hallsBookingApplication.auditDetails.createdTime

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedTime
          
       - query: INSERT INTO public.bank_account_details (bank_detail_id, booking_id, account_no, ifsc_code, bank_name, bank_branch_name, account_holder_name, refund_status, createdby, lastmodifiedby, createdtime, lastmodifiedtime) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?); 
         basePath: hallsBookingApplication.bankDetails
         jsonMaps:
          - jsonPath: $.hallsBookingApplication.bankDetails.bankDetailId

          - jsonPath: $.hallsBookingApplication.bankDetails.bookingId
          
          - jsonPath: $.hallsBookingApplication.bankDetails.accountNumber
          
          - jsonPath: $.hallsBookingApplication.bankDetails.ifscCode

          - jsonPath: $.hallsBookingApplication.bankDetails.bankName
          
          - jsonPath: $.hallsBookingApplication.bankDetails.bankBranchName

          - jsonPath: $.hallsBookingApplication.bankDetails.accountHolderName
          
          - jsonPath: $.hallsBookingApplication.bankDetails.refundStatus

          - jsonPath: $.hallsBookingApplication.auditDetails.createdBy

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedBy

          - jsonPath: $.hallsBookingApplication.auditDetails.createdTime

          - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedTime

- version: 1.0
      description: update community hall booking details
      fromTopic: update-community-hall-booking
      isTransaction: true
      queryMaps:

       - query: UPDATE community_hall_booking_details SET lastmodifiedby = ?, lastmodifiedtime = ? WHERE booking_id = ?;
         basePath: hallsBookingApplication
         jsonMaps:
           - jsonPath: $.hallsBookingApplication.bookingStatus
           - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedBy
           - jsonPath: $.hallsBookingApplication.auditDetails.lastModifiedTime
        